This problem came out to be a lot easier than I thought it would be. Some constraints make the problem a lot easier than first anticipated. There are some tricky things in the problem definition, too.

My Typescript implementation passed all C++ solutions and solutions in other languages in speed, and became 1st overall. Being able to achieve this result in a high-level language like Typescript is quite satisfying.